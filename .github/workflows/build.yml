name: üèóÔ∏è Build Android APK

on:
  workflow_dispatch:

jobs:
  build:
    runs-on: ubuntu-latest
    
    steps:
    # 1. T√©l√©charger le code
    - name: üì• Checkout
      uses: actions/checkout@v4
      
    # 2. Installer Java (ESSENTIEL pour Android)
    - name: ‚òï Install Java
      uses: actions/setup-java@v4
      with:
        distribution: 'temurin'
        java-version: '17'
        
    # 3. Installer Node.js
    - name: üü¢ Install Node.js
      uses: actions/setup-node@v4
      with:
        node-version: '18'
        
    # 4. Cr√©er la structure de fichiers
    - name: üìÅ Create project structure
      run: |
        # Cr√©er package.json
        echo '{
          "name": "mon-app-android",
          "version": "1.0.0",
          "description": "Mon application Android"
        }' > package.json
        
        # Cr√©er index.html dans www/
        mkdir -p www
        echo '<!DOCTYPE html>
        <html>
        <head>
            <meta charset="utf-8">
            <meta name="viewport" content="width=device-width, initial-scale=1">
            <title>Mon App Android</title>
            <style>
                body {
                    font-family: Arial, sans-serif;
                    text-align: center;
                    padding: 50px;
                    background: #4CAF50;
                    color: white;
                }
                .app {
                    background: white;
                    color: black;
                    padding: 30px;
                    border-radius: 15px;
                    margin: 20px auto;
                    max-width: 400px;
                    box-shadow: 0 5px 15px rgba(0,0,0,0.2);
                }
                button {
                    background: #2196F3;
                    color: white;
                    border: none;
                    padding: 15px 30px;
                    border-radius: 25px;
                    font-size: 16px;
                    margin: 10px;
                    cursor: pointer;
                }
            </style>
        </head>
        <body>
            <h1>üì± Mon App Android</h1>
            <div class="app">
                <h2>F√©licitations ! üéâ</h2>
                <p>Tu as r√©ussi √† cr√©er une APK Android sans PC !</p>
                <button onclick="alert(\'Bravo ! üëè\')">Clique ici</button>
                <button onclick="alert(\'Version 1.0.0\')">Version</button>
            </div>
            <p>Cr√©√© avec GitHub Actions</p>
        </body>
        </html>' > www/index.html
        
    # 5. Installer Capacitor
    - name: üì¶ Install Capacitor
      run: |
        npm install -g @capacitor/cli
        npm install @capacitor/core @capacitor/android
        
    # 6. Initialiser Capacitor (COMMANDE SIMPLIFI√âE)
    - name: üöÄ Initialize Capacitor
      run: |
        npx cap init "Mon App" "com.monapp.android" --web-dir www
        echo "‚úÖ Capacitor initialis√©"
        
    # 7. Ajouter Android
    - name: ü§ñ Add Android Platform
      run: |
        npx cap add android
        echo "‚úÖ Android ajout√©"
        
    # 8. Synchroniser
    - name: üîÑ Sync Project
      run: |
        npx cap sync
        echo "‚úÖ Projet synchronis√©"
        
    # 9. Builder l'APK
    - name: üèóÔ∏è Build APK
      run: |
        cd android
        chmod +x gradlew
        ./gradlew assembleDebug
        
    # 10. Uploader l'APK
    - name: üì§ Upload APK
      uses: actions/upload-artifact@v4
      with:
        name: app-android-apk
        path: android/app/build/outputs/apk/debug/*.apk
        
    # 11. Message final
    - name: üéâ Success Message
      run: |
        echo ""
        echo "‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà"
        echo "‚ñà                                      ‚ñà"
        echo "‚ñà   ‚úÖ APK ANDROID CR√â√â AVEC SUCC√àS!  ‚ñà"
        echo "‚ñà                                      ‚ñà"
        echo "‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà"
        echo ""
        echo "üì• Pour t√©l√©charger ton APK :"
        echo "1. Clique sur 'Artifacts' en bas"
        echo "2. T√©l√©charge 'app-android-apk'"
        echo "3. Installe sur ton t√©l√©phone Android"
        echo ""
